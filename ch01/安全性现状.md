# Spring Security是什么

+ 是Spring用于提供应用程序安全的一个框架，通过自定义配置实现自己所需的安全，能和Spring有良好的融合
+ 能为框架使用提供认证授权，密码工具和OAuth2集成的实现

# 软件安全性

**除了用户本人外，任何一方都不能与该数据进行任何形式的交互**

## 怎么关注？

我们应该以横向关注安全，即在关注于某一层时，只关注于加强该层，忽略掉其他层，这对于大层次而言。

**但对于我们关注的应用层中的MVC三层，应该连结关注**

<img src="https://cs8.intsig.net/sync/enhance_jpg?token=9F2A0ABE4A81415718AHL9EL&file_name=JRRE35QTe5VCAVArrMLhKPL7.jpg&t=1652689547818&rotate=0&mode=0" style="zoom:50%;" />

## 关注内容

+ 身份验证和授权
+ 如何避免通过凭据来授权所致的过分授权和凭据暴露
+ 数据存储
+ 内存管理（避免存储在内存的隐蔽数据，被dump下来读取到）

## 为什么要关注

+ 确保应用程序本身能稳定运行和数据不被收到影响
+ 公司名誉
+ 金钱利益



# 应用程序级别的常见漏洞

+ 不完整的身份认证

  仅仅做了简单的权限隔离，并没有实现数据对用户级别的隔离

+ 会话固定

  恶意用户A先登录构造了一个sessionId，然后生成一个url给用户B访问登录（以他的sessionId），登录后恶意用户A当前处理的数据和操作都是以用户B的身份

  https://www.cnblogs.com/echojson/p/12805102.html

+ 跨站脚本(XSS)

  恶意用户将脚本内容发布到论坛等网站，其他用户读取了这个内容后，加载了对应的脚本导致触发一些错误的请求到应用服务器，导致应用服务器异常

+ 跨站请求伪造(CSRF)

  用户A登录了系统X，然后A访问了一个恶意网站，触发脚本使用A原先登录系统X后完成认证的凭据来发送一些恶意请求给服务器（如转账等）

+ 注入

+ 敏感数据暴露

  + 本身敏感数据暴露（密码，卡号等）
  + 异常信息导致的数据暴露
    + 服务器信息
    + 异常堆栈

+ 缺乏方法访问控制

  在应用程序级别，不能应对其中某一层应用授权（如controller层），还要对service或dao层进行限制





# 各种架构中所应用的安全性

架构中对安全性的考虑是我们要求怎么样安全级别，我们要求要多好的性能？两者是成反比的

## OAuth2

通过认证获取令牌，令牌是对用户凭据的代替

+ 避免凭据暴露和过分授权**（细粒度的权限限制）**
+ 对用户权限和权限对应时间的限制，可由第三方使用**（可以控制令牌对应的权限）**
+ 令牌被截取只是需要对该令牌失效即可，而不是使得凭据失效**（身份认证和授权失效的成本更低）**
+ 令牌生命周期短，这导致令牌通过漏洞使用时间有限**（安全性更高）**

### 具体过程

+ **授权码模式**
+ 简单模式
+ 密码模式
+ 客户端模式

https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html

## API Key

在请求头或响应头中加入静态键，该键有对应身份和权限。这种方式是不安全的会在网络中暴露key内容（如果不是HTTPS）

## 加密签名

+ 非对称密钥
+ 公私钥和生成共享密钥（HTTPS）

## IP验证















